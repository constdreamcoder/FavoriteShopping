# PicPoint - ì‚¬ì§„ ìŠ¤íŒŸ ê³µìœ  ì•±

<p>
    <img src="https://github.com/constdreamcoder/SaSACRecap/assets/95998675/3525e2b0-b3db-40cd-af49-f4ec06abf3c7" align="center" width="100%"/>
</p>

<br/>

## PicPoint

- ì„œë¹„ìŠ¤ ì†Œê°œ: ì›í•˜ëŠ” ìƒí’ˆì„ ê±´ìƒ‰í•  ìˆ˜ ìˆëŠ” ì•±
- ê°œë°œ ì¸ì›: 1ì¸
- ê°œë°œ ê¸°ê°„: 24.01.21 ~ 24.01.24(ì´ 4ì¼)
- ê°œë°œ í™˜ê²½
  - ìµœì†Œë²„ì „: iOS 15
  - Portrait Orientation ì§€ì›
  - ë¼ì´íŠ¸ ëª¨ë“œ ì§€ì›

<br/>

## ğŸ’ª ì£¼ìš” ê¸°ëŠ¥

- ìƒí’ˆ ê²€ìƒ‰ ê¸°ëŠ¥
- ì„ í˜¸ ìƒí’ˆ ì°œ ê¸°ëŠ¥
- í”„ë¡œí•„ ìºë¦­í„° ì„ íƒ / ìˆ˜ì • ê¸°ëŠ¥
- ì‡¼í•‘ ìŠ¤ì¼€ì¤„ ê´€ë¦¬ ê¸°ëŠ¥

<br/>

## ğŸ“· ìŠ¤í¬ë¦°ìƒ·

|ê²€ìƒ‰ í™”ë©´|ê²€ìƒ‰ ê²°ê³¼ í™”ë©´|ìƒì„¸ í™”ë©´|í”„ë¡œí•„ í™”ë©´|
|:---:|:---:|:---:|:---:|
|<img src="https://github.com/user-attachments/assets/1a6693a4-86df-4b54-8830-6daa4109b0b5" width="200" height="390"/>|<img src="https://github.com/user-attachments/assets/8cfd1df3-d38e-4f8f-9c76-fe7523d2c725" width="200" height="390"/>|<img src="https://github.com/user-attachments/assets/1693c9a0-b4f2-4120-91ee-33c2240c3917" width="200" height="390"/>|<img src="https://github.com/user-attachments/assets/639a3ae3-6e3b-49a2-a626-1abb2141157e" width="200" height="390"/>|

|ì§„ì… í™”ë©´|í”„ë¡œí•„ ì„¤ì • í™”ë©´|í”„ë¡œí•„ ìºë¦­í„° ì„ íƒ í™”ë©´|
|:---:|:---:|:---:|
|<img src="https://github.com/user-attachments/assets/8d905543-4ed7-4b98-8c41-8f468fa504fd" width="200" height="390"/>|<img src="https://github.com/user-attachments/assets/a79c04b2-415e-4873-b018-8ccf4ded02e9" width="200" height="390"/>|<img src="https://github.com/user-attachments/assets/4fd42ec9-3d03-4068-9157-852d37c7094e" width="200" height="390"/>|

<br/>

## ğŸ›  ê¸°ìˆ  ì†Œê°œ

- UIKit
- MVC, StoryBoard, SnapKit
- Alamofire, Kingfisher
- UserDefaults
- Local Notification, Naver Shopping API

<br/>

## ğŸ’» ê¸°ìˆ  ì ìš©

- **Alamofire**ë¥¼ í™œìš©í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì½”ë“œ ê°„ì†Œí™”
- **UserDefaults**ë¥¼ í™œìš©í•œ ì°œí•œ ë°ì´í„° ì €ì¥
- **IBOutlet/IBAction** ì—°ê²°ì„ í†µí•œ UI ìš”ì†Œì™€ ì½”ë“œ ê°„ì˜ ì—°ê²° ë° ì•¡ì…˜ ì •ì˜
- **UIStackView**ë¥¼ í™œìš©í•œ UI ì •ë ¬
- **SnapKit**ì„ í™œìš©í•œ ì¼ë¶€ ë·° ì½”ë“œ ê¸°ë°˜ UIë¡œ ì „í™˜
- **prefetch**ë¥¼ ì´ìš©í•œ **Offset-Based Pagination** êµ¬í˜„
- **Local Notification**ë¥¼ í™œìš©í•œ ìœ ì € ì•Œë¦¼ êµ¬ì„±
- **Error** í”„ë¡œí† ì½œì„ ì¤€ìˆ˜í•˜ëŠ” ì—ëŸ¬ ì •ì˜ë¥¼ í†µí•´ ì‚¬ìš©ì ë‹‰ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬ ì²˜ë¦¬
- **WKWebView**ë¥¼ í™œìš©í•œ ì›¹ ì½˜í…ì¸  í‘œì‹œ
- **Kingfisher**ë¥¼ í†µí•œ ì™¸ë¶€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
- **Swift Concurrency**ë¥¼ í™œìš©í•œ ì§ê´€ì ì¸ ë„¤íŠ¸ì›Œí¬ ì½”ë“œ êµ¬ì„±
- **Naver Shopping API**ë¥¼ í†µí•œ ìƒí’ˆ ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

<br/>

## ğŸ’¾ êµ¬í˜„ ë‚´ìš©

### 1. SnapKitì„ í†µí•œ Code-Based UIë¡œ ì „í™˜

<details>
<summary><b>StoryBoard UI<b></summary>
<div markdown="1">

<img src="https://github.com/constdreamcoder/SaSACRecap/assets/95998675/c4a7799f-e122-4502-a7a9-1589f534498e" align="center" width="100%">

</div>
</details>

<details>
<summary><b>SnapKit UI<b></summary>
<div markdown="1">

```swift
// ì˜¨ë³´ë”© í™”ë©´ì—ì„œ Snapkitìœ¼ë¡œ êµ¬ì„±í•œ UI ì½”ë“œ
func configureConstraints() {
    appLogoImageViewContainer.addSubview(appLogoImageView)

    [
        appLogoImageViewContainer,
        onboardingImageView,
        startButton
    ].forEach { view.addSubview($0) }

    appLogoImageViewContainer.snp.makeConstraints {
        $0.top.horizontalEdges.equalTo(view.safeAreaLayoutGuide)
        $0.bottom.equalTo(onboardingImageView.snp.top)
    }

    appLogoImageView.snp.makeConstraints {
        $0.center.equalToSuperview()
        $0.width.equalToSuperview().multipliedBy(0.53)
        $0.height.equalTo(appLogoImageView.snp.width).multipliedBy(0.45)
    }

    onboardingImageView.snp.makeConstraints {
        $0.center.equalTo(view.safeAreaLayoutGuide)
        $0.width.equalTo(view.safeAreaLayoutGuide.snp.width).multipliedBy(0.9)
        $0.height.equalTo(onboardingImageView.snp.width)
    }

    startButton.snp.makeConstraints {
        $0.horizontalEdges.equalToSuperview().inset(24.0)
        $0.bottom.equalTo(view.safeAreaLayoutGuide.snp.bottom).offset(-16.0)
        $0.height.equalTo(50.0)
    }
}
```

</div>
</details>

<br/>

### 2. ë‹‰ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬ ì²˜ë¦¬

<details>
<summary><b>ë‹‰ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬ì— ëŒ€í•œ ì»¤ìŠ¤í…€ ì—ëŸ¬ ë° ì—ëŸ¬ ë©”ì„¸ì§€ ì—´ê±°í˜•</b></summary>
<div markdown="1">

```swift
enum NicknameValidationError: Error {
    case notInBetweenTwoAndTenLetters
    case containUnallowedSpecialCharacters
    case containNumbers

    var errorMessage: String {
        switch self {
        case .notInBetweenTwoAndTenLetters:
            return "2ê¸€ì ì´ìƒ 10ê¸€ì ë¯¸ë§Œìœ¼ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”"
        case .containUnallowedSpecialCharacters:
            return "ë‹‰ë„¤ì„ì— @, #, $, %ëŠ” í¬í•¨í•  ìˆ˜ ì—†ì–´ìš”"
        case .containNumbers:
            return "ë‹‰ë„¤ì„ì— ìˆ«ìëŠ” í¬í•¨í•  ìˆ˜ ì—†ì–´ìš”"
        }
    }

    var errorMessageTextColor: UIColor {
        return .red
    }
}

```

</div>
</details>

<details>
<summary><b>ë‹‰ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬ ë©”ì„œë“œ ë° ì—ëŸ¬ ë©”ì„¸ì§€ í‘œì‹œ ë©”ì„œë“œ</b></summary>
<div markdown="1">

```swift
// ë‹‰ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬
private func validateNickname(text: String) throws {
    guard text.count >= 2 && text.count < 10
    else {
        throw NicknameValidationError.notInBetweenTwoAndTenLetters
    }

    guard !text.contains("@") && !text.contains("#")
                && !text.contains("$") && !text.contains("%")
    else {
        throw NicknameValidationError.containUnallowedSpecialCharacters
    }

    guard text.filter({ $0.isNumber }).count < 1
    else {
        throw NicknameValidationError.containNumbers
    }
}

// ì—ëŸ¬ ë©”ì„¸ì§€ í‘œì‹œ ì •ì˜
private func showErrorMessage(error: NicknameValidationError) {
    errorMessageLabel.text = error.errorMessage
    errorMessageLabel.textColor = error.errorMessageTextColor
}
```

</div>
</details>

<details>
<summary><b>ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬ íƒ€ì…ì— ë”°ë¥¸ ì—ëŸ¬ ë©”ì„¸ì§€ í‘œì‹œ ë©”ì„œë“œ</b></summary>
<div markdown="1">

```swift
// ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬ íƒ€ì…ì— ë”°ë¥¸ ì—ëŸ¬ ë©”ì„¸ì§€ í‘œì‹œ
private func checkNicknameValidationAndShowErrorMessage(text: String) {
    do {
        try validateNickname(text: text)
        errorMessageLabel.text = "ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹‰ë„¤ì„ì´ì—ìš”"
        errorMessageLabel.textColor = Colors.pointColor
    } catch {
        switch error {
        case NicknameValidationError.notInBetweenTwoAndTenLetters:
            print("2ê¸€ì ì´ìƒ 10ê¸€ì ë¯¸ë§Œìœ¼ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”")
            showErrorMessage(error: NicknameValidationError.notInBetweenTwoAndTenLetters)
        case NicknameValidationError.containUnallowedSpecialCharacters:
            print("ë‹‰ë„¤ì„ì— @, #, $, %ëŠ” í¬í•¨í•  ìˆ˜ ì—†ì–´ìš”")
            showErrorMessage(error: NicknameValidationError.containUnallowedSpecialCharacters)
        case NicknameValidationError.containNumbers:
            print("ë‹‰ë„¤ì„ì— ìˆ«ìëŠ” í¬í•¨í•  ìˆ˜ ì—†ì–´ìš”")
            showErrorMessage(error: NicknameValidationError.containNumbers)
        default:
            print("ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ì…ë‹ˆë‹¤.")
        }
    }
}
```

</div>
</details>

<br/>

### 3. Swift Concurrencyë¥¼ í™œìš©í•œ ë„¤íŠ¸ì›Œí¬ ì½”ë“œ êµ¬ì„±

<details>
<summary><b>Swift Concurrency ë„¤íŠ¸ì›Œí¬ ì½”ë“œ</b></summary>
<div markdown="1">

```swift
// ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì •ì˜
enum NetworkError: Error {
    case unknownError
}

final class ShoppingManager {

    static let shared = ShoppingManager()

    private init() {}

    // ìƒí’ˆ ê²€ìƒ‰(Swift Concurrency í™œìš©)
    func fetchShoppingResults(
        keyword: String,
        sortingStandard: SortingStandard = .byAccuracy,
        start: Int = 1,
        display: Int = 30
    ) async throws -> SearchResultsModel {
        if let query = keyword.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed) {

            // í†µì‹  Base URL êµ¬ì„±
            let urlString = "https://openapi.naver.com/v1/search/shop.json?query=\(query)&display=\(display)&sort=\(sortingStandard.rawValue)&start=\(start)"

            // Header êµ¬ì„±
            let headers: HTTPHeaders = [
                "X-Naver-Client-Id": APIKeys.clientID,
                "X-Naver-Client-Secret": APIKeys.clientSecret
            ]

            // ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ìœ„í•œ dataTask êµ¬ì„±
            let dataTask = AF.request(urlString, method: .get, headers: headers)
                .validate(statusCode: 200..<300)
                .serializingDecodable(SearchResultsModel.self)

            // ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ë° ì‘ë‹µ ìˆ˜ì‹ 
            let result = await dataTask.result

            // ì‘ë‹µ ë‚´ìš© ë°˜í™˜
            switch result {
            case .success(let success):
                return success
            case .failure(let failure):
                throw failure
            }
        }
        throw NetworkError.unknownError
    }
}
```

</div>
</details>

<br/>

### 4. Local Notification êµ¬ì„±ì„ í†µí•œ ì‡¼í•‘ ëª©ë¡ ê´€ë¦¬ ì•Œë¦¼ ì œê³µ

<details>
<summary><b>Local Notification êµ¬ì„±</b></summary>
<div markdown="1">

```swift
func configureLocalNotifications() {
    let content = UNMutableNotificationContent()
    content.title = "ì‡¼í•‘ ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬!!"
    content.body = "ì‡¼í•‘ ë¦¬ìŠ¤íŠ¸ë¥¼ ê´€ë¦¬í•´ì£¼ì„¸ìš”!"

    var dateComponents = DateComponents()
    dateComponents.hour = 15

    let trigger = UNCalendarNotificationTrigger(dateMatching: dateComponents, repeats: true)
    let request = UNNotificationRequest(identifier: "\(Date())", content: content, trigger: trigger)

    UNUserNotificationCenter.current().add(request) { error in
        if let error = error {
            print("Notification Error: ", error)
        }
    }
}
```

</div>
</details>

<details>
<summary><b>Local Notification</b></summary>
<div markdown="1">

<img src="https://github.com/constdreamcoder/SwiftPrac/assets/95998675/f3d1e5e5-9cb1-4136-b2b2-89572ec2a92a" align="center" width="200">

</div>
</details>

<br/>

## ğŸ”¥ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### 1. ë¦¬í„°ëŸ´í•œ í˜•íƒœì˜ UserDefaults Key

ë¬¸ì œìƒí™©

- ë¦¬í„°ëŸ´í•œ í˜•íƒœë¡œ UserDefaults Key ì‚¬ìš©

    <details>
    <summary><b>ë¦¬í„°ëŸ´í•œ í˜•íƒœë¡œ ì‚¬ìš©ëœ UserDefaults Key</b></summary>
    <div markdown="1">

  ```swift
  override func viewWillAppear(_ animated: Bool) {
      super.viewWillAppear(animated)

      // profileImageView ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
      let profileImageName = UserDefaults.standard.string(forKey: "CurrentProfileImageName") ?? "no_image"
      profileImageView.image = UIImage(named: profileImageName)

      // nicknameLabel í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
      nicknameLabel.text = UserDefaults.standard.string(forKey: "Nickname") ?? ""

      // heartCountLabel í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ë° AttributedString ì ìš©
      guard let heartPressedList = UserDefaults.standard.dictionary(forKey: "HeartPressedList") else { return }

      // ...
  }
  ```

    </div>
    </details>

ë¬¸ì œ ì›ì¸ íŒŒì•…

- ë°˜ë³µì ì¸ UserDefaults Key ì‘ì„±ìœ¼ë¡œ ìœ ì§€ë³´ìˆ˜ ì‹œ íœ´ë¨¼ ì—ëŸ¬ ë°œìƒ ê°€ëŠ¥ì„± ìƒìŠ¹

í•´ê²°ë°©ë²•

- ì—´ê±°í˜•ì„ ì´ìš©í•˜ì—¬ UserDefaults Keyë¥¼ ë”°ë¡œ ì •ì˜ ë° ê´€ë¦¬

    <details>
    <summary><b>ì—´ê±°í˜•ìœ¼ë¡œ ì •ì˜ëœ UserDefaults Key</b></summary>
    <div markdown="1">

  ```swift
  enum UserDefaultsKeys: String, CaseIterable {
      case nickname = "Nickname"
      case userLoginState = "UserLoginState"
      case heartPressedList = "HeartPressedList"
      case recentKeywordList = "RecentKeywordList"
      case selectedProfileImageName = "SelectedProfileImageName"
      case currentProfileImageName = "CurrentProfileImageName"
  }
  ```

    </div>
    </details>

<br/>

### 2. HTML íƒœê·¸ ì²˜ë¦¬

ë¬¸ì œìƒí™©

- ë„¤ì´ë²„ ì‡¼í•‘ API í˜¸ì¶œ ì‹œ ì‘ë‹µì— HTML íƒœê·¸ê°€ í¬í•¨ëœ ë¬¸ìì—´ì´ ë°˜í™˜

   <img src="https://github.com/constdreamcoder/SwiftPrac/assets/95998675/725aedf8-f29b-4c6d-b3c3-ce9bba122122" align="center" width="200">

í•´ê²°ë°©ë²•

- NSAttributedStringì„ í™œìš©í•˜ì—¬ HTML íƒœê·¸ê°’ ì œê±° ë° HTML ì¸ì½”ë”©ëœ ë¬¸ìì—´ì„ ì¼ë°˜ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ì‚¬ìš©ìê°€ ì‰½ê²Œ ì½ì„ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

    <details>
    <summary><b>ì—´ê±°í˜•ìœ¼ë¡œ ì •ì˜ëœ UserDefaults Key</b></summary>
    <div markdown="1">

  ```swift
  var htmlTagEraser: String {
    // ë¬¸ìì—´ì„ UTF-8 ì¸ì½”ë”©ëœ Dataë¡œ ë³€í™˜
    guard let data = self.data(using: .utf8) else { return self }

    // NSAttributedStringì˜ ì´ˆê¸°í™”ì— ì‚¬ìš©í•  ì˜µì…˜ ì •ì˜
    let options: [NSAttributedString.DocumentReadingOptionKey: Any] = [
        .documentType: NSAttributedString.DocumentType.html, // ë¬¸ì„œ ìœ í˜•ì„ HTMLë¡œ ì„¤ì •
        .characterEncoding: String.Encoding.utf8.rawValue // ë¬¸ì ì¸ì½”ë”©ì„ UTF-8ë¡œ ì„¤ì •
    ]

    do {
        // NSAttributedStringì„ ì‚¬ìš©í•˜ì—¬ HTML ë°ì´í„°ë¥¼ ë””ì½”ë”©í•˜ì—¬ ì¼ë°˜ ë¬¸ìì—´ë¡œ ë³€í™˜
        let attributed = try NSAttributedString(data: data, options: options, documentAttributes: nil)
        return attributed.string // ë³€í™˜ëœ ë¬¸ìì—´ì„ ë°˜í™˜
    } catch {
        return self // ë³€í™˜ì— ì‹¤íŒ¨í•˜ë©´ ì›ë˜ ë¬¸ìì—´ì„ ë°˜í™˜
    }
  }
  ```

    </div>
    </details>

